{% extends "base.html" %}
{% block content %}
<h2>Welcome, {{ email }}</h2>

<!-- Storage Usage -->
<div class="card">
  <h5>Storage Usage</h5>
  <p>{{ (used/1024/1024)|round(1) }} MB of {{ (total/1024/1024/1024)|round(1) }} GB used</p>
  <div class="progress">
    <div class="progress-bar" style="width: {{ percent }}%;">
      {{ percent }}%
    </div>
  </div>
</div>

<!-- Upload Section -->
<div class="card">
  <h5>Upload File</h5>
  <form method="POST" action="{{ url_for('upload') }}" enctype="multipart/form-data">
    <input type="file" name="file" class="form-control mb-2" required>
    <button class="btn btn-primary w-100">Upload</button>
  </form>
  <p class="hint">Drag & drop files here or use the button above.</p>
</div>

<!-- File List -->
<div class="card">
  <h5>Your Files</h5>
  {% if files and files|length > 0 %}
    <table class="table">
      <thead>
        <tr>
          <th>Filename</th>
          <th>Size</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for f in files %}
        <tr>
          <td>{{ f.filename }}</td>
          <td>{{ (f.size/1024)|round(1) }} KB</td>
          <td>
            <a class="btn btn-sm btn-success" href="{{ url_for('download', filename=f.filename|urlencode) }}">Download</a>
            <form method="POST" action="{{ url_for('delete', filename=f.filename|urlencode) }}" style="display:inline;">
              <button class="btn btn-sm btn-danger">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No files uploaded yet. Start by adding one above!</p>
  {% endif %}
</div>
{% endblock %}